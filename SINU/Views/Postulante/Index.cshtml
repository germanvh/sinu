    @model SINU.ViewModels.IDPersonaVM
@{
    ViewBag.Title = "Secuencias";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@*@section MenuPerfil{

        @Html.Partial("_MenuPerfilPostu")
    }*@

<link href="~/Content/CssPostulante.css" rel="stylesheet" />
<br />
<h3>Etapas de la Inscripcion</h3>
<br />
@* TAB GENERAL DONDE FIGURAN LAS DISTINTAS ETAPAS DE LA INSCRIPCION PARA EL POSTULANTE *@

<div class="p-1 bg-white rounded shadow mb-1 h-75" style="padding:0px !important">

    <ul id="TabGeneral" role="tablist" class="nav nav-tabs nav-pills with-arrow lined bg-dark flex-sm-row text-center" style="padding-bottom:0.2rem">

        @* PERSONA DATOS BASICOS ID=2 *@
        <li class="nav-item flex-sm-fill" id="2">
            <a id="datosbasicos-tab" data-toggle="tab" href="#datosbasicos" role="tab" aria-controls="datosbasicos" aria-selected="true" class="nav-link text-uppercase font-weight-bold mr-sm-3 rounded-0 active atab">
                1° Datos Basicos
            </a>
        </li>

        @* DIA Y HORA DE ENTREVISTA EN LA DELEGACION ID=3 *@
        <li class="nav-item flex-sm-fill" id="3" data-placement="top">
            <a id="entrevista-tab" data-toggle="tab" href="#entrevista" role="tab" aria-controls="entrevista" aria-selected="false" class="nav-link text-uppercase font-weight-bold mr-sm-3 rounded-0 atab">
                2° Entrevista
            </a>
        </li>

        @* DOCUMENTACION ID=4 *@
        <li class="nav-item flex-sm-fill" id="4" data-placement="top">
            <a id="Documentacion-tab" data-toggle="tab" href="#Documentacion" role="tab" aria-controls="Documentacion" aria-selected="false" class="nav-link text-uppercase font-weight-bold mr-sm-3 rounded-0 atab">
                3° Documentacion
            </a>
        </li>

        @* PRESENTACION ID= 5 *@
        <li class="nav-item flex-sm-fill " id="5" data-placement="top">
            <a id="Presentacion-tab" data-toggle="tab" href="#Presentacion" role="tab" aria-controls="Presentacion" aria-selected="false" class="nav-link text-uppercase font-weight-bold rounded-0 atab">
                4° Presentacion
            </a>
        </li>
    </ul>

    <div id="myTab2Content" class="tab-content " >

        @* VISTA VPERSONA DATOS BASICOS CON ID = 2 *@
        <div id="datosbasicos" role="tabpanel" aria-labelledby="datosbasicos-tab" class="tab-pane fade px-4 py-3 show active">
            @if (Model.EtapaTabs.Contains(2))
            {
                @Html.Action("DatosBasicos", "Postulante", new { ID_persona = Model.ID_PER })
            }
        </div>

        @* VISTA DIA Y HORA DE ENTREVISTA EN LA DELEGACION // ID = 3 *@
        <div id="entrevista" role="tabpanel" aria-labelledby="entrevista-tab" class="tab-pane fade px-4 py-3">
            @if (Model.EtapaTabs.Contains(3))
            {
                @Html.Action("Entrevista", "Postulante", new { ID_persona = Model.ID_PER })
            }

        </div>

        @* VISTA DE Documentacion CON ID = 4, que se divide en varias vistas PARCIALES *@
        <div id="Documentacion" role="tabpanel" aria-labelledby="profile-tab" class="tab-pane fade  p-0 navbar-expand-lg h-75">

            @if (Model.EtapaTabs.Contains(4))
            {
                <div class="container p-0">
                    <div class="row">


                        <nav class="col-sm-2 mr-3 navbar navbar1 navbar-expand-md  navbar-light  bg-dark ml-3 pl-2 oculto">
                            @*<a class="navbar-brand" href="#">Navbar</a>*@


                            <!-- Navbar links -->
                            <div class="collapse navbar-collapse" id="TABDocumentacion">
                                <ul class="nav nav-tabs nav-pills with-arrow lined  flex-sm-row text-left" id="myTab" role="tablist" style="border-bottom: 0px solid;">
                                    <li class="nav-item flex-sm-fill bli">
                                        <a class="nav-link text-uppercase font-weight-bold  rounded-0 active atab" data-toggle="tab" href="#DatosPersonales" role="tab" aria-controls="DatosPersonales" aria-selected="true">
                                            Datos Personales
                                        </a>
                                    </li>
                                    <li class="nav-item flex-md-fill bli">
                                        <a class="nav-link text-uppercase font-weight-bold rounded-0 atab" data-toggle="tab" href="#Domicilio" role="tab" aria-controls="Domicilio" aria-selected="false">
                                            Domicilio
                                        </a>
                                    </li>
                                    <li class="nav-item flex-md-fill bli">
                                        <a class="nav-link text-uppercase font-weight-bold rounded-0 atab" data-toggle="tab" href="#Estudios" role="tab" aria-controls="Estudios" aria-selected="false">
                                            Estudios
                                        </a>
                                    </li>
                                    <li class="nav-item flex-md-fill bli">
                                        <a class="nav-link text-uppercase font-weight-bold rounded-0 atab" data-toggle="tab" href="#Idiomas" role="tab" aria-controls="Idiomas" aria-selected="false">
                                            Idiomas
                                        </a>
                                    </li>
                                    <li class="nav-item flex-md-fill bli">
                                        <a class="nav-link text-uppercase font-weight-bold rounded-0 atab" data-toggle="tab" href="#ActMilitar" role="tab" aria-controls="ActMilitar" aria-selected="false">
                                            Actividad Militar
                                        </a>
                                    </li>
                                    <li class="nav-item flex-md-fill bli">
                                        <a class="nav-link text-uppercase font-weight-bold rounded-0 atab" data-toggle="tab" href="#SituOcu" role="tab" aria-controls="SituOcu" aria-selected="false">
                                            Situacion Ocupacional
                                        </a>
                                    </li>
                                    <li class="nav-item flex-md-fill bli">
                                        <a class="nav-link text-uppercase font-weight-bold rounded-0 atab" data-toggle="tab" href="#Antropometria" role="tab" aria-controls="Antropometria" aria-selected="false">
                                            Antropometria
                                        </a>
                                    </li>
                                    <li class="nav-item flex-md-fill bli" id="FamiTAB">
                                        <a class="nav-link text-uppercase font-weight-bold rounded-0 atab" data-toggle="tab" href="#Familia" role="tab" aria-controls="Familia" aria-selected="false">
                                            Familia
                                        </a>
                                    </li>
                                    <li class="nav-item flex-md-fill bli" id="ValidarTAB">
                                        <a class="nav-link text-uppercase font-weight-bold rounded-0 atab" data-toggle="tab" href="#ValidarDatos" role="tab" aria-controls="ValidarDatos" aria-selected="false">
                                            Validar Datos
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </nav>


                        <div class="col-md-9 borderdiv1">
                            @*<div class="mt-4  position-absolute col-md-11">
                                <button class="btn btn-success float-md-left" >Envia a Validar</button>
                            </div>*@

                            <div class="tab-content TABMovil" id="TabDocumentacion">
                                @* VISTA DE DATO PERSONAL *@
                                <div class="pos-f-t collapse tab-pane fade show active tab-nav" id="DatosPersonales">
                                    <nav class="navbar navbar-dark bg-dark ocultnav">
                                        <a class="navbar-brand" href="#">Datos Personales</a>
                                        <button id="BTDatosPersonalesNAV" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#DatosPersonalesNAV" role="tabpanel" aria-labelledby="DatosPersonalesNAV-tab" aria-controls="DatosPersonalesNAV" aria-expanded="false" aria-label="Toggle navigation">
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                        </button>
                                    </nav>
                                    <div class="collapse tab-pane fade show active nav-tab pt-4" id="DatosPersonalesNAV">
                                        @Html.Action("DatosPersonales", "Postulante", new { ID_persona = Model.ID_PER })
                                    </div>

                                </div>


                                @* VISTA DE DOMICILIO *@
                                <div class="pos-f-t collapse tab-pane fade tab-nav" id="Domicilio">
                                    <nav class="navbar navbar-dark bg-dark ocultnav">
                                        <a class="navbar-brand" href="#">Domicilio</a>
                                        <button id="BTDomicilioNAV" class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#DomicilioNAV" role="tabpanel" aria-labelledby="DomicilioNAV-tab" aria-controls="DomicilioNAV" aria-expanded="false" aria-label="Toggle navigation">
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                        </button>
                                    </nav>
                                    <div class="collapse tab-pane fade nav-tab pt-4" id="DomicilioNAV">
                                        @Html.Action("Domicilio", "Postulante", new { ID_persona = Model.ID_PER })
                                    </div>

                                </div>

                                @* VISTA DE ESTUDIOS *@
                                <div class="pos-f-t collapse tab-pane fade tab-nav" id="Estudios">
                                    <nav class="navbar navbar-dark bg-dark ocultnav">
                                        <a class="navbar-brand" href="#">Estudios</a>
                                        <button id="BTEstudiosNAV" class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#EstudiosNAV" role="tabpanel" aria-labelledby="EstudiosNAV-tab" aria-controls="EstudiosNAV" aria-expanded="false" aria-label="Toggle navigation">
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                        </button>
                                    </nav>
                                    <div class="collapse tab-pane fade nav-tab pt-4" id="EstudiosNAV">
                                        @Html.Action("Estudios", "Postulante", new { ID_persona = Model.ID_PER })
                                    </div>

                                </div>


                                @* VISTA DE IDIOMAS *@
                                <div class="pos-f-t collapse tab-pane fade tab-nav" id="Idiomas">
                                    <nav class="navbar navbar-dark bg-dark ocultnav">
                                        <a class="navbar-brand" href="#">Idiomas</a>
                                        <button id="BTIdiomasNAV" class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#IdiomasNAV" role="tabpanel" aria-labelledby="IdiomasNAV-tab" aria-controls="IdiomasNAV" aria-expanded="false" aria-label="Toggle navigation">
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                        </button>
                                    </nav>
                                    <div class="collapse tab-pane fade nav-tab  pt-4" id="IdiomasNAV">
                                        @Html.Action("Idiomas", "Postulante", new { ID_persona = Model.ID_PER })
                                    </div>
                                </div>

                                @* VISTA DE ACTIVIDAD MILITAR *@
                                <div class="pos-f-t collapse tab-pane fade tab-nav" id="ActMilitar">
                                    <nav class="navbar navbar-dark bg-dark ocultnav">
                                        <a class="navbar-brand" href="#">Activiadad Militar</a>
                                        <button id="BTActMilitarNAV" class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#ActMilitarNAV" role="tabpanel" aria-labelledby="ActMilitarNAV-tab" aria-controls="ActMilitarNAV" aria-expanded="false" aria-label="Toggle navigation">
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                        </button>
                                    </nav>
                                    <div class="collapse tab-pane fade nav-tab pt-4" id="ActMilitarNAV">
                                        @Html.Action("ActMilitar", "Postulante", new { ID_persona = Model.ID_PER })
                                    </div>
                                </div>

                                @* VISTA DE SITUACION OCUPACIONAL*@
                                <div class="pos-f-t collapse tab-pane fade tab-nav" id="SituOcu">
                                    <nav class="navbar navbar-dark bg-dark ocultnav">
                                        <a class="navbar-brand" href="#">Situcion Ocipacional</a>
                                        <button id="BTSituOcuNAV" class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#SituOcuNAV" role="tabpanel" aria-labelledby="SituOcuNAV-tab" aria-controls="SituOcuNAV" aria-expanded="false" aria-label="Toggle navigation">
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                        </button>
                                    </nav>
                                    <div class="collapse tab-pane fade nav-tab pt-4" id="SituOcuNAV">
                                        @Html.Action("SituOcupacional", "Postulante", new { ID_persona = Model.ID_PER })
                                    </div>
                                </div>

                                @* VISTA DE ANTROPOMETRIA *@
                                <div class="pos-f-t collapse tab-pane fade tab-nav" id="Antropometria">
                                    <nav class="navbar navbar-dark bg-dark ocultnav">
                                        <a class="navbar-brand" href="#">Antropometria</a>
                                        <button id="BTAntropometriaNAV" class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#AntropometriaNAV" role="tabpanel" aria-labelledby="AntropometriaNAV-tab" aria-controls="AntropometriaNAV" aria-expanded="false" aria-label="Toggle navigation">
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                        </button>
                                    </nav>
                                    <div class="collapse tab-pane fade nav-tab pt-4" id="AntropometriaNAV">
                                        @Html.Action("Antropometria", "Postulante", new { ID_persona = Model.ID_PER })
                                    </div>
                                </div>

                                @* VISTA DE FAMILIA*@
                                <div class="pos-f-t collapse tab-pane fade tab-nav" id="Familia">
                                    <nav class="navbar navbar-dark bg-dark ocultnav">
                                        <a class="navbar-brand" href="#">Familia</a>
                                        <button id="BTFamiliaNAV" class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#FamiliaNAV" role="tabpanel" aria-labelledby="FamiliaNAV-tab" aria-controls="FamiliaNAV" aria-expanded="false" aria-label="Toggle navigation">
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                        </button>
                                    </nav>
                                    <div class="collapse tab-pane fade nav-tab pt-4" id="FamiliaNAV">
                                        @Html.Action("Familia", "Postulante", new { ID_persona = Model.ID_PER })
                                    </div>
                                </div>
                                
                                @* Validar Datos*@
                                <div class="pos-f-t collapse tab-pane fade tab-nav" id="ValidarDatos">
                                    <nav class="navbar navbar-dark bg-dark ocultnav">
                                        <a class="navbar-brand" href="#">Validar Datos</a>
                                        <button id="BTValidarDatosNAV" class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#ValidarDatosNAV" role="tabpanel" aria-labelledby="ValidarDatosNAV-tab" aria-controls="ValidarDatosNAV" aria-expanded="false" aria-label="Toggle navigation">
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                        </button>
                                    </nav>
                                    <div class="collapse tab-pane fade nav-tab pt-4" id="ValidarDatosNAV">

                                        <h2>Validar Datos</h2>
                                        <div class="jumbotron mb-0" style="background-color: #08495f; color:white">
                                            <p>Antes de enviar a Validar los Datos cargados verifique los mismos, para no ntorpecer el Proceso de Inscripcion.</p>
                                            <br />
                                            @Ajax.ActionLink("Solicitar Validacion de Datos", "ValidarDatos", new { ID_persona = Model.ID_PER }, new AjaxOptions
                                                      {
                                                        HttpMethod = "POST",
                                                        OnSuccess = "Exito(data,status,xhr)",
                                                        OnFailure = "Falla"
                                                      }, new { @id = "BTValidar", @class = "btn btn-success" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /.col-md-8 -->
                    </div>
                </div>

            }
        </div>

        @* VISTA DE PRESENTACION CON ID = 5 *@
        <div id="Presentacion" role="tabpanel" aria-labelledby="Presentacion-tab" class="tab-pane fade px-4 py-3">

            @if (Model.EtapaTabs.Contains(5))
            {
                @Html.Action("Presentacion", "Postulante", new { ID_persona = Model.ID_PER })

            }

        </div>

    </div>
    <!-- End lined tabs -->
</div>



@*////////////////////////////////////////////////////////////////////////////////////////////*@
@*MODAL DE LA VISTA ESTUDIO, IDIOMA y ACTIVIDAD MILITAR VER SI SIRVE PARA QUE VISTAS PUEDE SERVIR*@
<div class="modal fade " id="ModalEIA" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" style="position:absolute !important;">
    <div class="modal-dialog modal-dialog-centered modal-lg " role="document">
        <div class="modal-content " id="ModalEIACuerpo">

            <!----------------------------------------VISTA PARCIAL PARA LA ACTULIZACION Y CREAION DE REGISTRO DE ESTUDIOS DEL POSTULANTE------------------------------------------------------>

        </div>
    </div>
</div>


<div class="modal fade" id="ModalAnuncios" tabindex="-1" role="dialog" aria-labelledby="ModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ModalCenterTitle">@* Titulo del modal *@</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p id="TextModal">@* mensaje del Modal *@</p>
            </div>
            <div class="modal-footer ">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="BTNModal">@* TExto de Boton *@</button>
                <button type="button" class="btn btn-primary" id="GuardarDTF">Guardar de todas formas</button>
            </div>
        </div>
    </div>
</div>


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script type="text/javascript" src="~/Scripts/JavaScriptPostulante.js"></script>
    <script type="text/javascript">

        //VER COMO ANEJAR LO DELOS CAMBIOS DE UN CAMPO Y NO SE LO ALLAS GUARDADO

        //var select = [];
        //$(document).ready( function () {
        //    $("input, select").change(function () {
        //        //alert("se modifico un campo de carga de datos!!!" + $(this).attr("id") + select.length);
        //        var id_form_elemento = [$(this).closest("form").attr("id"),$(this).attr("id")];
        //        select.push(id_form_elemento)
        //    });
        //});


        //    $(window).unbind().bind('beforeunload', (e) => {
        //        if (select.length>0) {
        //            MarcaCambios();
        //        return true;
        //        }
        //        return;
        //    });


        //    function MarcaCambios() {
        //        $.each(select, function (e,i) {
        //            //alert(e + "  ---  " + i[0] + "---" + i[1]);
        //            $("#" + i[1]).addClass("cambio").focus();
        //        });
        //    };

        //    $("#jeje").click(function () {
        //        $.each(select, function (e,i) {
        //            //alert(e + "  ---  " + i[0] + "---" + i[1]);
        //        });
        //    });

        $(document).ready(function () {
            //Funcion para deshabilitar las opciones del tab principal segun las Etapas Recibidas en el Model.IDETAPA
            (function () {

                //ID de las Etpas por las que paso el Postulante
                var IDETP = '@Model.IDETAPA.ToString()'.split(',');
                //elimino el ultimo elemnto de array, por que es un string vacio
                IDETP.splice(IDETP.length - 1);
                //alert('@Model.IDETAPA.ToString()' + "    " + IDETP.indexOf("2") + "        " + (IDETP.length -1 ));
                if (IDETP.indexOf("2") < (IDETP.length - 1)) {
                    $("#BTDatosBasicos").html("");
                    $("#datosbasicos :input,#datosbasicos input").attr("disabled", "true");
                };

                $("#TabGeneral li").each(function () {
                    idTAB = $(this).attr("id");
                    //alert(IDETP.indexOf(idTAB));
                    if (IDETP.indexOf(idTAB)<0) {
                        $(this)
                            .addClass('Tabdesabilitado')
                            .css("color", "gray")
                            .attr("data-toggle", "tooltip")
                            .attr("title","Opcion deshabilitada hasta que avance de secuencia")
                            .tooltip('enable');
                    };
                });
                //alert(IDETP.length);
                //Muestro el Tab de la Etapa en la que me encuentro actualmente
                $("#" + IDETP.length + " a").tab("show");
            })();

        });

        function HabilitarTAb(idtab) {
            $("#"+idtab)
                .removeClass('Tabdesabilitado')
                .css("color", "white")
                .removeAttr("data-toggle", "tooltip")
                .removeAttr("title", "Opcion deshabilitada hasta que avance de secuencia")
                .tooltip('disable');
        };

        /////////////////////////////////////////////////////////////////////////////////
        /*FUNCIONES DE AJAX.BeginForm*/

        function Exito(response, status, xhr) {
            $("#BTNModal").html("Cerrar");
            $("#GuardarDTF").css("display", "none");
            $("#ModalCenterTitle").html("SINU:");
            $("#TextModal").html(response.msg);
            $("#ModalAnuncios").modal();
            //alert("success: " + response.success + " - " + response.msg);
            switch (response.form) {
                case "datosbasicos":
                    $("#BTentrevista").removeClass("disabled");
                    break;
                case "solicitudentrevista":
                    HabilitarTAb(3);
                    $("#3 a").tab("show");
                    $("#BTDatosBasicos").html("");
                    $("#datosbasicos :input,#datosbasicos input").attr("disabled", "true");
                    $("#entrevista").load('/Postulante/Entrevista', { ID_persona: @Model.ID_PER });
                    break;
                case "Elimina":
                    $.ActualizaTabla(response.url_Tabla);
                    break;
                default:
            };
        };

        function Falla(response) {
            $("#BTNModal").html("Cerrar");
            $("#GuardarDTF").css("display", "none");
            $("#ModalCenterTitle").html("SINU:");
            $("#TextModal").html("Error Inesperado!!! Recarga la Paguna e Intentalo de Nuevo.");
            $("#ModalAnuncios").modal();
        };

        //$(function () {
        //    $('#frmEnvio').unbind().submit(function (e) {
        //        e.preventDefault();
        //        Enviar(data);
        //    });
        //});

        //function Enviar(data) {
        //    $.ajax({
        //        type: "POST",
        //        url: url,
        //        data: data,
        //        success: function (data) {
        //            $('#objeto').html(data);
        //        }
        //    });
        //}


    </script>

}

